/* 自定义BlockNote样式 */

/* 强制使用light主题，避免系统主题影响 */
.bn-container {
  --bn-colors-editor-background: #ffffff !important;
  --bn-colors-editor-text: #374151 !important;
  --bn-colors-menu-background: #ffffff !important;
  --bn-colors-menu-text: #374151 !important;
  --bn-colors-tooltip-background: #ffffff !important;
  --bn-colors-tooltip-text: #374151 !important;
  --bn-colors-hovered-background: #f3f4f6 !important;
  --bn-colors-hovered-text: #1f2937 !important;
  --bn-colors-selected-background: #3b82f6 !important;
  --bn-colors-selected-text: #ffffff !important;
  --bn-colors-border: #e5e7eb !important;
  --bn-colors-shadow: rgba(0, 0, 0, 0.05) !important;
  --bn-colors-side-menu: #9ca3af !important;

  background-color: #ffffff !important;
  color: #374151 !important;
}

/* 确保在任何主题下都使用light样式 */
.dark .bn-container,
html.dark .bn-container,
[data-theme="dark"] .bn-container,
[data-color-scheme="dark"] .bn-container,
.bn-container[data-color-scheme="dark"] {
  --bn-colors-editor-background: #ffffff !important;
  --bn-colors-editor-text: #374151 !important;
  --bn-colors-menu-background: #ffffff !important;
  --bn-colors-menu-text: #374151 !important;
  --bn-colors-tooltip-background: #ffffff !important;
  --bn-colors-tooltip-text: #374151 !important;
  --bn-colors-hovered-background: #f3f4f6 !important;
  --bn-colors-hovered-text: #1f2937 !important;
  --bn-colors-selected-background: #3b82f6 !important;
  --bn-colors-selected-text: #ffffff !important;
  --bn-colors-border: #e5e7eb !important;
  --bn-colors-shadow: rgba(0, 0, 0, 0.05) !important;
  --bn-colors-side-menu: #9ca3af !important;

  background-color: #ffffff !important;
  color: #374151 !important;
}

/* 强制覆盖任何可能的系统主题检测 */
@media (prefers-color-scheme: dark) {
  .bn-container {
    --bn-colors-editor-background: #ffffff !important;
    --bn-colors-editor-text: #374151 !important;
    --bn-colors-menu-background: #ffffff !important;
    --bn-colors-menu-text: #374151 !important;
    --bn-colors-tooltip-background: #ffffff !important;
    --bn-colors-tooltip-text: #374151 !important;
    --bn-colors-hovered-background: #f3f4f6 !important;
    --bn-colors-hovered-text: #1f2937 !important;
    --bn-colors-selected-background: #3b82f6 !important;
    --bn-colors-selected-text: #ffffff !important;
    --bn-colors-border: #e5e7eb !important;
    --bn-colors-shadow: rgba(0, 0, 0, 0.05) !important;
    --bn-colors-side-menu: #9ca3af !important;

    background-color: #ffffff !important;
    color: #374151 !important;
  }
}

/* 预览模式下的代码块样式 */
.preview-mode .bn-code-block {
  background-color: white !important;
  color: #1f2937 !important; /* text-gray-900 */
  border: 1px solid #e5e7eb !important; /* border-gray-200 */
  border-radius: 0.375rem !important; /* rounded-lg */
}

/* 强制预览模式下的代码块内容样式 */
.preview-mode .bn-code-block pre {
  background-color: white !important;
  color: #1f2937 !important;
}

/* 预览模式下的代码块容器 */
.preview-code-container {
  background-color: white !important;
  border: 1px solid #e5e7eb !important;
  border-radius: 0.375rem !important;
  margin: 0.5rem 0 !important;
}

/* 预览模式下的代码 */
.preview-code-block {
  background-color: white !important;
  color: #1f2937 !important;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace !important;
  font-size: 0.875rem !important; /* text-sm */
  white-space: pre !important;
  overflow-x: auto !important;
}

/* 强制禁用编辑 */
.preview-mode [contenteditable="true"] {
  cursor: default !important;
  -webkit-user-select: text !important;
  user-select: text !important;
}

/* 隐藏编辑按钮和控件 */
.preview-mode .bn-inline-menu,
.preview-mode .bn-floating-menu,
.preview-mode .bn-formatting-toolbar {
  display: none !important;
}

/* 自定义编辑器根元素样式 */
.custom-editor-root {
  background-color: #f9fafc !important; /* 更清爽的浅灰色背景 */
  border: 1px solid #e5e7eb !important; /* 更淡的边框颜色 */
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.03) !important; /* 更淡的阴影 */
  padding: 1rem !important;
  /* 移除纹理效果，使设计更简洁 */
}

/* 自定义段落样式 */
.custom-editor-root [data-content-type="paragraph"] {
  color: #2d3748 !important; /* 深灰色文本 */
  line-height: 1.6 !important;
}

/* 自定义标题样式 */
.custom-editor-root [data-content-type="heading"] {
  color: #2563eb !important; /* 更现代的蓝色标题 */
  font-weight: 600 !important;
  text-align: center !important; /* 标题居中 */
}

/* 增强列表样式 */
.custom-editor-root [data-content-type="bulletListItem"],
.custom-editor-root [data-content-type="numberedListItem"] {
  margin-left: 0.5rem !important;
}

/* ===== 基本的Notion风格提示 ===== */

/* 增强当前活动块的视觉反馈 */
.bn-container [data-is-active="true"] {
  background-color: rgba(37, 99, 235, 0.05) !important; /* 更轻的蓝色 */
  border-radius: 4px !important;
}

/* 改进空行的显示 */
.bn-container [data-content-type="paragraph"]:empty::after {
  content: "按回车新建一行..." !important;
  color: #a1a1aa !important; /* 更协调的灰色 */
  font-style: italic !important;
  font-size: 14px !important;
  position: absolute !important;
  top: 4px !important;
  left: 6px !important;
  pointer-events: none !important;
}

/* 斜杠菜单样式 */
.bn-slash-menu {
  border-radius: 8px !important;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08) !important; /* 更轻的阴影 */
  overflow: hidden !important;
}

/* ===== 分割线样式 ===== */

/* 分割线容器样式 */
.bn-divider-container {
  margin: 16px 0 !important;
  padding: 8px 0 !important;
  display: flex !important;
  justify-content: center !important;
  align-items: center !important;
  width: 100% !important;
}

/* 分割线本身的样式 */
.bn-divider {
  width: 100% !important;
  height: 0 !important;
  border: none !important;
  border-top: 1px solid #6b7280 !important; /* 添加实际的边框 */
  margin: 0 !important;
  opacity: 0.8 !important;
  transition: opacity 0.2s ease !important;
}

/* 分割线悬停效果 */
.bn-divider-container:hover .bn-divider {
  opacity: 0.8 !important;
}

/* 分割线在选中状态下的样式 */
.bn-container [data-content-type="divider"][data-is-selected="true"] .bn-divider {
  opacity: 1 !important;
  box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.3) !important;
  border-radius: 2px !important;
}

/* 分割线在预览模式下的样式 */
.preview-mode .bn-divider-container {
  margin: 20px 0 !important;
}

.preview-mode .bn-divider {
  opacity: 0.8 !important;
  border-top: 1px solid #6b7280 !important; /* 确保预览模式下也有边框 */
}

/* 深色主题下的分割线样式 */
.dark .bn-divider {
  border-color: #4b5563 !important;
}

/* 分割线的不同颜色变体 */
.bn-divider[data-color="blue"] {
  border-top-color: #3b82f6 !important;
}

.bn-divider[data-color="red"] {
  border-top-color: #ef4444 !important;
}

.bn-divider[data-color="green"] {
  border-top-color: #10b981 !important;
}

.bn-divider[data-color="yellow"] {
  border-top-color: #f59e0b !important;
}

.bn-divider[data-color="purple"] {
  border-top-color: #8b5cf6 !important;
}

/* ===== BlockNote编辑器现代风格 ===== */
.bn-container {
  --bn-colors-editor-background: #ffffff !important;
  --bn-colors-border: #e5e7eb !important;
  --bn-colors-shadow: rgba(0, 0, 0, 0.05) !important;

  /* 整体样式调整 */
  background-color: white !important;
  border-radius: 8px !important;
  border: 1px solid #e5e7eb !important;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05) !important;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif !important;

  /* 编辑模式：全宽布局，左对齐 */
  width: 100% !important;
  margin: 0 !important;
}

/* 编辑器块样式 */
.bn-container > div > div {
  margin-bottom: 2px !important;
  border-radius: 4px !important;
  transition: background-color 0.2s !important;
}

/* 编辑区域样式 */
.bn-container [contenteditable="true"] {
  padding: 3px 5px !important;
  border-radius: 4px !important;
  transition: background-color 0.2s !important;
}

/* 编辑区域激活样式 */
.bn-container [contenteditable="true"]:focus {
  background-color: rgba(59, 130, 246, 0.04) !important;
}

/* 标题样式优化 */
.bn-container [data-content-type="heading"] {
  margin-top: 10px !important;
  margin-bottom: 5px !important;
  font-weight: 600 !important;
  text-align: left !important; /* 编辑模式：标题左对齐 */
}

/* 段落样式 */
.bn-container [data-content-type="paragraph"] {
  color: #374151 !important;
  line-height: 1.6 !important;
  /* 编辑模式：左对齐，全宽 */
  max-width: 100% !important;
  width: 100% !important;
  margin: 0 !important;
  text-align: left !important;
}

/* 预览模式下的特殊样式 - 限制文字和背景宽度 */
.preview-mode .bn-container {
  /* 预览模式：居中布局，限制宽度 */
  max-width: 640px !important;
  margin: 0 auto !important;
}

.preview-mode .bn-container [data-content-type="paragraph"],
.preview-mode .bn-container [data-content-type="heading"] {
  /* 文字内容宽度自适应，背景色只覆盖文字区域 */
  width: fit-content !important;
  max-width: 100% !important;
  padding: 4px 8px !important;
  border-radius: 4px !important;
  /* 移除强制居中，让内容保持原有对齐方式 */
}

/* 预览模式下根据文本对齐属性来设置样式 */
/* 左对齐（默认） */
.preview-mode .bn-container [data-content-type="paragraph"]:not([data-text-alignment]),
.preview-mode .bn-container [data-content-type="heading"]:not([data-text-alignment]),
.preview-mode .bn-container [data-content-type="paragraph"][data-text-alignment="left"],
.preview-mode .bn-container [data-content-type="heading"][data-text-alignment="left"] {
  margin: 0 !important;
  text-align: left !important;
}

/* 居中对齐 */
.preview-mode .bn-container [data-content-type="paragraph"][data-text-alignment="center"],
.preview-mode .bn-container [data-content-type="heading"][data-text-alignment="center"] {
  margin: 0 auto !important;
  text-align: center !important;
}

/* 右对齐 */
.preview-mode .bn-container [data-content-type="paragraph"][data-text-alignment="right"],
.preview-mode .bn-container [data-content-type="heading"][data-text-alignment="right"] {
  margin: 0 0 0 auto !important;
  text-align: right !important;
}

/* 两端对齐 */
.preview-mode .bn-container [data-content-type="paragraph"][data-text-alignment="justify"],
.preview-mode .bn-container [data-content-type="heading"][data-text-alignment="justify"] {
  margin: 0 !important;
  text-align: justify !important;
}

/* 确保选中状态的背景色只覆盖文字区域 */
.preview-mode .bn-container [data-is-active="true"] {
  background-color: transparent !important;
}

.preview-mode .bn-container [data-is-active="true"] [data-content-type="paragraph"],
.preview-mode .bn-container [data-is-active="true"] [data-content-type="heading"] {
  background-color: rgba(147, 100, 237, 0.1) !important; /* 淡紫色背景，只覆盖文字 */
  width: fit-content !important;
  /* 移除强制居中，保持原有对齐方式 */
}

/* 图片样式 - 添加下方间距 */
.bn-container [data-content-type="image"] {
  margin-bottom: 20px !important; /* 图片下方添加20px间距 */
}

.preview-mode .bn-container [data-content-type="image"] {
  margin-bottom: 24px !important; /* 预览模式下图片下方添加更多间距 */
}

/* 图片容器样式优化 */
.bn-container img {
  margin-bottom: 16px !important; /* 图片元素本身也添加下边距 */
  border-radius: 8px !important; /* 添加圆角 */
}